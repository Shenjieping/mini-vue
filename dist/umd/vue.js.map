{"version":3,"file":"vue.js","sources":["../../src/util/index.js","../../src/observer/index.js","../../src/state.js","../../src/init.js","../../src/index.js"],"sourcesContent":["export function isObject(obj) {\n  return obj && typeof obj === 'object';\n}","import { isObject } from \"../util/index\";\n\nclass Observer {\n  constructor(value) {\n    this.value = value;\n    if (Array.isArray(value)) {\n\n    } else {\n      // 如果是对象，则进行下一步\n      this.walk(value);\n    }\n  }\n  walk(obj) {\n    let keys = Object.keys(obj);\n    // 循环每一个key，添加get/set\n    for (let i = 0; i < keys.length; i++) {\n      let key = keys[i];\n      let value = obj[key];\n      defineReactive(obj, key, value); // 定义响应式数据\n    }\n  }\n}\n\nexport function defineReactive(obj, key, value) {\n  // 递归设置嵌套的对象\n  observe(value);\n  Object.defineProperty(obj, key, {\n    get() {\n      return value;\n    },\n    set(newValue) { // 设置值的时候做一些操作\n      if (value === newValue) {\n        return;\n      }\n      console.log('update 视图更新');\n      observe(newValue); // 如果新设置的值是一个对象，也要被监控\n      value = newValue;\n    }\n  })\n}\n\n// 用于观测数据，给每个属性添加 get 和 set 方法\nexport function observe(value) {\n  if (!isObject(value)) {\n    return;\n  }\n  return new Observer(value)\n}","import { observe } from \"./observer/index\";\n\nexport function initState(vm) {\n  const opts = vm.$options;\n  // Vue 的数据来源\n  if (opts.props) {\n    initProps(vm);\n  }\n  if (opts.methods) {\n    initMethods(vm);\n  }\n  if (opts.data) {\n    initData(vm);\n  }\n  if (opts.computed) {\n    initComputed(vm);\n  }\n  if (opts.watch) {\n    initWatch(vm);\n  }\n}\n\nfunction initProps(vm) {\n  \n}\nfunction initMethods(vm) {\n  \n}\nfunction initData(vm) {\n  // 数据初始化\n  let data = vm.$options.data;\n  data = vm._data = typeof data === 'function' ? data.call(vm) : data;\n  // 对象劫持，用户改变了数据，我希望能检测到，从而更新页面\n  // MVVM 数据变化可以驱动视图\n\n  // 通过Object.defineProperty 给属性增加get和set方法\n  observe(data); // 响应式原理\n}\nfunction initComputed(vm) {\n  \n}\nfunction initWatch(vm) {\n  \n}","import { initState } from './state';\n// 在原型上添加一个init方法\nexport function initMixin (Vue) {\n  // 初始化流程\n  Vue.prototype._init = function(options) {\n    // 数据的劫持\n    const vm = this;\n    // vue 中使用 this.$options 指代的就是用户传递的属性\n    vm.$options = options;\n\n    // 初始化转态\n    initState(vm); // 分割代码\n  }\n}","// Vue核心代码\nimport { initMixin } from './init'\nfunction Vue(options) {\n  // 进行Vue的初始化操作\n  this._init(options);\n}\n\ninitMixin(Vue);\n\nexport default Vue;"],"names":["isObject","obj","Observer","value","Array","isArray","walk","keys","Object","i","length","key","defineReactive","observe","defineProperty","get","set","newValue","console","log","initState","vm","opts","$options","props","methods","data","initData","computed","watch","_data","call","initMixin","Vue","prototype","_init","options"],"mappings":"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"}