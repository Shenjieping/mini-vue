## 对象的数据劫持

1. 判断传入的数据是否是一个对象，如果不是则不做任何处理

```js
if (!isObject(value)) {
  return;
}
```

2. 创建一个Observer类，在类中判断是数组还是对象。如果是对象，则给对象的每一个属性都添加上get/set

```js
class Observer {
  constructor(value) {
    this.value = value;
    if (Array.isArray(value)) {

    } else {
      // 如果是对象，则进行下一步
      this.walk(value);
    }
  }
  walk(obj) {
    let keys = Object.keys(obj);
    // 循环每一个key，添加get/set
    for (let i = 0; i < keys.length; i++) {
      let key = keys[i];
      let value = obj[key];
      defineReactive(obj, key, value); // 定义响应式数据
    }
  }
}
```

3. 响应式的核心，通过Object.defindeProperty 监控对象的修改

```js
export function defineReactive(obj, key, value) {
  // 递归设置嵌套的对象
  observe(value);
  Object.defineProperty(obj, key, {
    get() {
      return value;
    },
    set(newValue) { // 设置值的时候做一些操作
      if (value === newValue) {
        return;
      }
      console.log('update 视图更新');
      observe(newValue); // 如果新设置的值是一个对象，也要被监控
      value = newValue;
    }
  })
}
```